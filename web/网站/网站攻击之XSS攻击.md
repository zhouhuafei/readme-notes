# XSS是什么？
* XSS, 即为（Cross Site Scripting）, 中文名为跨站脚本, 是发生在目标用户的浏览器层面上的，当渲染DOM树的过程成发生了不在预期内执行的JS代码时，就发生了XSS攻击。
* XSS攻击全称跨站脚本攻击，是为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS，XSS是一种在web应用中的计算机安全漏洞，它允许恶意web用户将代码植入到提供给其它用户使用的页面中。
* 跨站脚本的重点不在‘跨站’上，而在于‘脚本’上。大多数XSS攻击的主要方式是嵌入一段远程或者第三方域上的JS代码。实际上是在目标网站的作用域下执行了这段js代码。
* 和SQL注入类似。

# 原理
* 注入js脚本。获取用户信息。

# 供给渠道
* 留言板中输入js代码。如果后端渲染时不做处理，则js代码就会被触发。
* 富文本中输入js代码。如果后端渲染时不做处理，则js代码就会被触发。

# 个人总结
* 代码不严谨才会被XSS攻击。用户输入的东西都应该当做字符串处理。

# 防御
* 给关键cookie设置httpOnly上防止cookie被盗。
* 后端渲染时需要对内容进行过滤。例如不使用```<%= userInputContent %>```注入用户输入的内容(ejs模板)。使用```<%- userInputContent %>```代替。
    - 问：如果是富文本内容呢？怎么过滤？有现成的包么？
    - 答：富文本的话。ejs模板渲染```<%= userInputContent %>```时，是会把```&，<，>，"，'，，/```这几个字符转义掉的。也就是说ejs本身是有防御XSS攻击能力的。
    - 问：那能在接口保存的时候就进行转义么？有现成的包么？
    - 答：https://github.com/leizongmin/js-xss
* 前端渲染时需要对内容进行过滤。例如不使用innerHTML注入用户输入的内容。使用innerText代替。
    - 问：如果是富文本内容呢？怎么过滤？有现成的包么？
    - 答：像vue这种框架默认就可以防止XSS攻击。
    - 问：如果原生js呢？有防止XSS攻击的包么？
    - 答：https://github.com/leizongmin/js-xss
* 小总结：其实成熟的富文本插件以及成熟的模板渲染包。本身就自带防御XSS攻击的能力。
* 重点总结：对需要渲染html内容的地方。要进行XSS防御处理。
