# token之同一个浏览器多个窗口多个账号同时登录在线
* 存储哪些用户登录过
    - 登录时，把后端返回的token和uid存到localStorage，以对象的形式存储，用一个唯一不会变的值(uid)当key，记录哪些用户登录过(记录用户信息和token)，便于后续用户重新登录时，进行token更新。
    - 建议把用户在线的标识也存到里面去(如果是用uid当标识，那么可以不存)，便于后续选择用户登录时提取用户标识。
* 存储当前是哪个用户在线的标识
    - 方案1、登录时，把当前是哪个用户在线的标识，存到sessionStorage里，sessionStorage仅和当前窗口有关，和其他窗口互不影响，即使url相同也互不影响。
        - 缺点，关闭窗口，这个用户就相当于下线了。
    - 方案2、登录时，把当前是哪个用户在线的标识存url里，这样只要记住url，即使刷新页面或者新打开一个窗口，把这个url贴进去就算是登录。
        - 优点，重新打开一个窗口，把url贴进去，只要token没过期就算是这个用户登录了，很方便快捷。
        - 缺点，关闭窗口，没记住url，这个用户就相当于下线了。
        - 安全因素，不存在安全问题。即使这个url发给了别人，别人也没有用，因为别人没有token。
        - 其他人只有拿到了你的uid和token，那么在token未过期之前，你的账号就存在风险。
* 退出账号不清理登录痕迹。直接打接口退出。
    - 退出后端会更新掉token，前端不用做处理。
* 退出账号并清理登录痕迹。直接打接口退出。
    - 清理登录痕迹，就需要去localStorage中把用户列表对应的用户清理掉。
* token为了安全考虑一般是两个小时就过期了。
    - 过期之后重新登录，登录完毕更新localStorage中用户列表里对应用户的token值。
* 这种功能，还有一个弊端，那就是浏览器关闭，所有人就同时下线了，因为你拿不到唯一标识了。
    - 错误的解决方案
        - 每次登陆就在cookie里也记录一个值，这样当找不到用户标识了，就可以找这个值，当做是在线用户。
        - 这样做的话，其他用户就没办登录了，因为默认登录了一个账号。
    - 正确的解决方案
        - 用户下次进来就重新登录，重新登录时，有个可选方案。
        - 如果localStorage中有用户列表，就可以给用户一个选择用户登录的入口。
        - 选择时，打个接口查看用户的token是否过期了。
        - 如果token过期了,提示token已过期，让用户重新输入密码进行登录并更新用户在线标识。
        - 如果没过期，直接更新用户在线标识并直接使用这个token获取数据即可。
