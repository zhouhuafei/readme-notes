# 一个允许任何来源请求的api服务器怎么做权限验证
* 首先网站要允许被跨域请求 Access-Control-Allow-Origin: *

# 过滤一部分不合法来源的请求
* 接口验签（这里的接口验签只是防止别人拿到接口一直请求罢了。如果别人破解了验签的加密方式，依然是可以重复打接口的。）

# token
* 登录，后端会返回utoken和uid。
* 后续请求带上utoken和uid即可。
    - 因为跨主域cookie带不过去，所以绑定到cookie上只是方便前端后续拿token，带给后端是带不过去的。
    - token的有效时间应该要和后端确认，对应的cookie也要存对应的时长。

# 后端生成token的原理
* 待续...

# token的存储
* 待续...

# token的更新
* 待续...

# token的安全性
* 别人拿到token和uid，也就拿到了登录权限。
* 不跨主域，可以把token存cookie里，加上httponly，会相对安全很多。

# session
* 只要不跨主域，是可以把登录状态保存到session上的，所以没问题。
* 本地开发的时候可以使用服务器代理，此时session也是可以传回来的。所以是可以进行登录的。
* 如果跨主域了，那就没办法了，因为服务端返响应的set-cookie没办法跨主域设置到浏览器里的，除非线上你也使用了服务器代理。
* 没跨主域，没跨子域的情况下，前后端分离，前端进行本地独立开发的时候，先设置服务器代理，然后随便打个接口，把sessionid关联才可以。到了线上是不需要主动拿sessionid的。
* 没跨主域，跨子域的情况下，前后端分离，前端进行本地开发和上线的时候都需要手动打接口关联sessionid。
* sessionid要想跨自子域，需要设置cookie的时，domian前面要加上一个点(.)。
